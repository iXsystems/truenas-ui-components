<tn-dialog-shell title="Backup Configuration Wizard" [showFullscreenButton]="true">
    <div style="padding: 0 var(--tn-content-padding); margin-top: var(--tn-content-padding);">
    <tn-stepper orientation="auto" [linear]="true" [selectedIndex]="currentStep" (selectionChange)="onStepChange($event)">
    
    <tn-step label="Backup Target">
        <h4>Select Backup Target</h4>
        <p>Choose where you want to store your backup data.</p>
        <div style="margin-top: 16px;">
        <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--tn-fg1);">
            Backup Destination
            </label>
            <div style="display: flex; flex-direction: column; gap: 8px;">
            <tn-radio name="backupTarget" value="local" label="Local Storage - Fast, no network required" [(ngModel)]="backupTarget" />
            <tn-radio name="backupTarget" value="cloud" label="Cloud Storage - Off-site protection" [(ngModel)]="backupTarget" />
            <tn-radio name="backupTarget" value="remote" label="Remote Server - Network attached storage" [(ngModel)]="backupTarget" />
            </div>
        </div>
        </div>
    </tn-step>

    <tn-step label="Credentials">
        <h4>Authentication & Credentials</h4>
        <p>Select an existing account to use for your backup.</p>
        <div style="margin-top: 16px;">
        <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--tn-fg1);">
            Choose an account
            </label>
            <tn-select placeholder="Select an account"
                        [options]="accountOptions"
                        [(ngModel)]="selectedAccount" />
        </div>
        </div>
    </tn-step>

    <tn-step label="Select Dataset">
        <h4>Choose Dataset to Backup</h4>
        <p>Enter the dataset path you want to include in your backup.</p>
        <div style="margin-top: 16px;">
        <div style="margin-bottom: 12px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--tn-fg1);">
            Dataset Path
            </label>
            <tn-input [placeholder]="'Enter dataset path (e.g., pool1/documents)'"
                    [(ngModel)]="selectedDatasetPath" />
        </div>
        <div>
            <tn-checkbox label="Include snapshots in backup" [(ngModel)]="includeSnapshots" />
        </div>
        </div>
    </tn-step>

    <tn-step label="Review">
        <h4>Review Configuration</h4>
        <p>Please review your backup configuration before proceeding.</p>
        <div style="margin-top: 16px;">
        <div style="background: var(--tn-bg2); padding: 16px; border-radius: 8px; border: 1px solid var(--tn-lines);">
            <div style="display: grid; gap: 12px;">
            <div>
                <strong style="color: var(--tn-fg1);">Backup Target:</strong>
                <span style="margin-left: 8px; color: var(--tn-fg2);">{{ getBackupTargetLabel(backupTarget) }}</span>
            </div>
            <div>
                <strong style="color: var(--tn-fg1);">Account:</strong>
                <span style="margin-left: 8px; color: var(--tn-fg2);">{{ getAccountLabel(selectedAccount) }}</span>
            </div>
            <div>
                <strong style="color: var(--tn-fg1);">Dataset:</strong>
                <span style="margin-left: 8px; color: var(--tn-fg2);">{{ selectedDatasetPath || 'Not specified' }}</span>
            </div>
            <div>
                <strong style="color: var(--tn-fg1);">Include Snapshots:</strong>
                <span style="margin-left: 8px; color: var(--tn-fg2);">{{ includeSnapshots ? 'Yes' : 'No' }}</span>
            </div>
            </div>
        </div>
        <div style="margin-top: 16px; padding: 12px; color:var(--tn-green); border-radius: 4px; font-size: 14px;">
            <strong>Ready to create backup task!</strong> All configuration is valid and complete.
        </div>
        </div>
    </tn-step>

    </tn-stepper>
    </div>
    
    <div tnDialogAction>
    <tn-button variant="outline"
                label="Cancel"
                (click)="cancel()" />
    @if (currentStep > 0) {
    <tn-button variant="outline"
                label="Back"
                (click)="previousStep()" />
    }
    <tn-button color="primary"
                [label]="getNextButtonLabel()"
                [disabled]="!canProceed()"
                (click)="nextStep()" />
    </div>
</tn-dialog-shell>