<tn-dialog-shell title="Create Virtual Machine" [showFullscreenButton]="true">
    <tn-tabs orientation="vertical" [selectedIndex]="0">
    <tn-tab label="General" />
    <tn-tab label="OS" />
    <tn-tab label="System" />
    <tn-tab label="Disks" />
    <tn-tab label="CPU" />
    <tn-tab label="Memory" />
    <tn-tab label="Network" />

    <tn-tab-panel>
        <div style="padding: 0 16px;">
        <h2 style="color: var(--fg2);">General</h2>
        <p style="margin-bottom: 16px; color: var(--fg2);">Basic virtual machine identification and placement.</p>
        
        <div style="display: grid; gap: 16px;">
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">VM Name</label>
            <tn-input placeholder="my-virtual-machine" [(ngModel)]="vmConfig.general.name" />
            </div>
            
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">Description</label>
            <tn-input placeholder="Brief description of this VM" [(ngModel)]="vmConfig.general.description" />
            </div>
            
            <div>
            <tn-checkbox label="Start on boot" [(ngModel)]="vmConfig.general.autoStart" />
            </div>
            
            <div>
            <tn-checkbox label="Enable VNC remote access" [(ngModel)]="vmConfig.general.enableVnc" />
            </div>
        </div>
        </div>
    </tn-tab-panel>

    <tn-tab-panel>
        <div style="padding: 0 16px;">
        <h2 style="color: var(--fg2);">OS</h2>
        <p style="margin-bottom: 16px; color: var(--fg2);">Operating system configuration and installation media.</p>
        
        <div style="display: grid; gap: 16px;">
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">Guest Operating System</label>
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <tn-radio name="osType" value="linux" label="Linux" [(ngModel)]="vmConfig.os.type" />
                <tn-radio name="osType" value="windows" label="Windows" [(ngModel)]="vmConfig.os.type" />
                <tn-radio name="osType" value="freebsd" label="FreeBSD" [(ngModel)]="vmConfig.os.type" />
                <tn-radio name="osType" value="other" label="Other" [(ngModel)]="vmConfig.os.type" />
            </div>
            </div>
            
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">Installation Media</label>
            <tn-select placeholder="Select ISO image" [options]="isoOptions" [(ngModel)]="vmConfig.os.bootImage" />
            </div>
            
            <div>
            <tn-checkbox label="Install from network" [(ngModel)]="vmConfig.os.networkInstall" />
            </div>
        </div>
        </div>
    </tn-tab-panel>

    <tn-tab-panel>
        <div style="padding: 0 16px;">
        <h2 style="color: var(--fg2);">System</h2>
        <p style="margin-bottom: 16px; color: var(--fg2);">Hardware abstraction and system firmware settings.</p>
        
        <div style="display: grid; gap: 16px;">
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">Machine Type</label>
            <tn-select [options]="machineOptions" [(ngModel)]="vmConfig.system.machine" />
            </div>
            
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">Boot Method</label>
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <tn-radio name="bootMethod" value="uefi" label="UEFI" [(ngModel)]="vmConfig.system.bootMethod" />
                <tn-radio name="bootMethod" value="legacy" label="Legacy BIOS" [(ngModel)]="vmConfig.system.bootMethod" />
            </div>
            </div>
            
            <div>
            <tn-checkbox label="Enable Secure Boot" [disabled]="vmConfig.system.bootMethod !== 'uefi'" [(ngModel)]="vmConfig.system.secureBoot" />
            </div>
        </div>
        </div>
    </tn-tab-panel>

    <tn-tab-panel>
        <div style="padding: 0 16px;">
        <h2 style="color: var(--fg2);">Disks</h2>
        <p style="margin-bottom: 16px; color: var(--fg2);">Storage configuration and disk settings.</p>
        
        <div style="display: grid; gap: 16px;">
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">Create new disk</label>
            <tn-checkbox label="Create a new virtual disk" [(ngModel)]="vmConfig.disks.createNew" />
            </div>

            @if (vmConfig.disks.createNew) {
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">Disk Size (GB)</label>
            <tn-input type="number" placeholder="20" [(ngModel)]="vmConfig.disks.size" />
            </div>
            }
            
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">Disk Type</label>
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <tn-radio name="diskType" value="virtio" label="VirtIO (Recommended)" [(ngModel)]="vmConfig.disks.type" />
                <tn-radio name="diskType" value="ahci" label="AHCI" [(ngModel)]="vmConfig.disks.type" />
                <tn-radio name="diskType" value="ide" label="IDE (Legacy)" [(ngModel)]="vmConfig.disks.type" />
            </div>
            </div>
        </div>
        </div>
    </tn-tab-panel>

    <tn-tab-panel>
        <div style="padding: 0 16px;">
        <h2 style="color: var(--fg2);">CPU</h2>
        <p style="margin-bottom: 16px; color: var(--fg2);">Processor configuration and CPU topology.</p>
        
        <div style="display: grid; gap: 16px;">
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">CPU Cores</label>
            <tn-input type="number" placeholder="2" [(ngModel)]="vmConfig.cpu.cores" />
            </div>
            
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">CPU Threads</label>
            <tn-input type="number" placeholder="1" [(ngModel)]="vmConfig.cpu.threads" />
            </div>
            
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">CPU Mode</label>
            <tn-select [options]="cpuModeOptions" [(ngModel)]="vmConfig.cpu.mode" />
            </div>
            
            <div>
            <tn-checkbox label="Enable CPU hotplug" [(ngModel)]="vmConfig.cpu.hotplug" />
            </div>
        </div>
        </div>
    </tn-tab-panel>

    <tn-tab-panel>
        <div style="padding: 0 16px;">
        <h2 style="color: var(--fg2);">Memory</h2>
        <p style="margin-bottom: 16px; color: var(--fg2);">RAM allocation and memory ballooning configuration.</p>
        
        <div style="display: grid; gap: 16px;">
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">Memory Size (MB)</label>
            <tn-input type="number" placeholder="4096" [(ngModel)]="vmConfig.memory.size" />
            </div>
            
            <div>
            <tn-checkbox label="Enable memory ballooning" [(ngModel)]="vmConfig.memory.ballooning" />
            </div>
            
            <div>
            <tn-checkbox label="Enable memory hotplug" [(ngModel)]="vmConfig.memory.hotplug" />
            </div>
        </div>
        </div>
    </tn-tab-panel>

    <tn-tab-panel>
        <div style="padding: 0 16px;">
        <h2 style="color: var(--fg2);">Network</h2>
        <p style="margin-bottom: 16px; color: var(--fg2);">Network adapter configuration and connectivity settings.</p>
        
        <div style="display: grid; gap: 16px;">
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">Network Interface</label>
            <tn-select [options]="networkOptions" [(ngModel)]="vmConfig.network.interface" />
            </div>
            
            <div>
            <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--fg1);">NIC Type</label>
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <tn-radio name="nicType" value="virtio" label="VirtIO (Recommended)" [(ngModel)]="vmConfig.network.nicType" />
                <tn-radio name="nicType" value="e1000" label="Intel E1000" [(ngModel)]="vmConfig.network.nicType" />
                <tn-radio name="nicType" value="rtl8139" label="Realtek RTL8139" [(ngModel)]="vmConfig.network.nicType" />
            </div>
            </div>
            
            <div>
            <tn-checkbox label="Attach to bridge" [(ngModel)]="vmConfig.network.bridge" />
            </div>
        </div>
        </div>
    </tn-tab-panel>
    </tn-tabs>
    
    <div tnDialogAction>
    <tn-button variant="outline" 
                label="Cancel"
                (click)="cancel()" />
    <tn-button color="primary" 
                label="Create Virtual Machine"
                (click)="createVM()" />
    </div>
</tn-dialog-shell>